The goal of this project is to build an ML model capable of determining, based on images, whether a solid is dissolved in a specific solvent. Although the concept is rather simple, we wanted to emphasize its immediate practical application in a prototype laboratory automated SwissCAT+, present at EPFL. The objective is to be able, without human intervention, to determine if a compound in solution is dissolved. To do this, we first created a setup allowing us to capture the images ourselves, to directly obtain an image format that will correspond to the final automated version. The setup consists of a light panel irradiating the sample from below, a plate containing 96 vials, and a Raspberry Pi capturing images from above. There are two major parts here: image preprocessing to prepare them for use in the second part, the training and testing of the various machine learning models employed.

We are using a transfer learning model to perform a binary classification task. This pre-trained model is already capable of differentiating between two specific categories, thanks to the extensive dataset it was originally trained on. To adapt it to our needs, we simply add our own data on top and fine-tune the model. This way, we leverage the knowledge the model has already acquired, allowing us to achieve precise and efficient results without having to train a completely new model from scratch. For our specific task, we need to separate our images into two groups: dissolved and non-dissolved, labeling them distinctly.

The first step is image preprocessing, where with the help of the 'img_preprocessing.py' script, the images will be cropped to select a specific region (during the final setup, an appropriate presetting of the Raspberry Pi will eliminate this part), and then we convert our color images to grayscale images using the 'cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)' function, where each pixel is represented by a luminance value ranging from 0 to 255, with 0 corresponding to absolute black and 255 to complete white.

To label our images, in the different 'transfer_learning_...' scripts, we will assign a label of 0 to our image if its name ends with 'soluble.jpg' and a label of 1 if it ends with 'insoluble.jpg'. The images will then be resized to a specific number of pixels, and the pixel values will be normalized to [0, 1]. Our image set will then be split into training and testing sets in an 80% - 20% proportion. The chosen pre-trained ML model is loaded while excluding the top layers, which will be replaced by custom classification layers. These custom layers consist of 'Global Average Pooling' layers followed by fully connected layers to adapt the model to our specific dataset. The lower layers of the model are frozen to prevent them from being updated during training. The model is then trained and tested while avoiding overfitting by adding an EarlyStopping function, which stops the training prematurely if a certain condition is not met. Finally, the model is saved as a keras file.
